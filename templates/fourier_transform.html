<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transformada de Fourier - Visualização Interativa</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/fourier.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Source+Code+Pro:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="terminal-effect"></div>
    
    <div class="container">
        <header>
            <h1 class="glitch"><i class="fas fa-wave-square"></i> Visualização da Transformada de Fourier</h1>
            <p class="subtitle">Decomposição de sinais em componentes de frequência</p>
        </header>

        <main>
            <div class="control-panel" data-label="CONTROL_PANEL">
                <div class="controls">
                    <div class="control-group">
                        <label for="signal-type"><i class="fas fa-signal"></i> Tipo de Sinal</label>
                        <select id="signal-type">
                            <option value="sine">Seno Puro</option>
                            <option value="square">Onda Quadrada</option>
                            <option value="triangle">Onda Triangular</option>
                            <option value="sawtooth">Dente de Serra</option>
                            <option value="composite">Sinal Composto</option>
                            <option value="custom">Sinal Personalizado</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label for="frequency"><i class="fas fa-tachometer-alt"></i> Frequência (Hz)</label>
                        <input type="range" id="frequency" min="1" max="10" step="0.1" value="3">
                        <span id="frequency-value">3.0 Hz</span>
                    </div>

                    <div class="control-group">
                        <label for="harmonics"><i class="fas fa-layer-group"></i> Harmônicos</label>
                        <input type="range" id="harmonics" min="1" max="20" value="5">
                        <span id="harmonics-value">5</span>
                    </div>

                    <div class="control-group">
                        <label for="animation-speed"><i class="fas fa-forward"></i> Velocidade</label>
                        <input type="range" id="animation-speed" min="1" max="10" value="5">
                        <span id="speed-value">5</span>
                    </div>

                    <div class="buttons">
                        <button id="play-pause" class="btn"><i class="fas fa-play"></i> Reproduzir/Pausar</button>
                        <button id="reset" class="btn"><i class="fas fa-redo"></i> Reiniciar</button>
                    </div>
                </div>

                <div class="explanation" data-label="HOW_IT_WORKS">
                    <h3><i class="fas fa-lightbulb"></i> Como funciona</h3>
                    <p>A Transformada de Fourier decompõe um sinal complexo em uma soma de senos e cossenos de diferentes frequências. Esta visualização mostra como sinais periódicos podem ser reconstruídos a partir de suas componentes de frequência.</p>
                </div>
            </div>

            <div class="visualization-container">
                <div class="canvas-container" data-label="TIME_DOMAIN">
                    <h2><i class="fas fa-chart-line"></i> Sinal no Domínio do Tempo</h2>
                    <canvas id="time-domain"></canvas>
                    <div class="canvas-description">
                        <p>Representação do sinal como função do tempo. Quanto mais complexo o sinal, mais componentes de frequência são necessárias para representá-lo.</p>
                    </div>
                </div>

                <div class="canvas-container" data-label="FREQUENCY_DOMAIN">
                    <h2><i class="fas fa-chart-bar"></i> Espectro de Frequências</h2>
                    <canvas id="frequency-domain"></canvas>
                    <div class="canvas-description">
                        <p>Espectro de frequências mostrando a amplitude de cada componente senoidal que compõe o sinal. Barras mais altas representam componentes mais fortes.</p>
                    </div>
                </div>

                <div class="canvas-container" data-label="FOURIER_CIRCLES">
                    <h2><i class="fas fa-project-diagram"></i> Círculos de Fourier</h2>
                    <canvas id="fourier-circles"></canvas>
                    <div class="canvas-description">
                        <p>Cada círculo gira com uma frequência e raio correspondentes a uma componente do sinal. A projeção do ponto final cria o sinal reconstruído.</p>
                    </div>
                </div>
            </div>

            <div class="info-panel">
                <div class="info-box" data-label="ABOUT_FOURIER">
                    <h3><i class="fas fa-history"></i> Sobre a Transformada de Fourier</h3>
                    <p>A Transformada de Fourier, desenvolvida por Joseph Fourier, é uma ferramenta matemática que permite decompor funções em componentes de senos e cossenos. Ela transforma um sinal do domínio do tempo para o domínio da frequência, revelando as frequências presentes no sinal original.</p>
                </div>
                <div class="info-box" data-label="SIMULATION_CONTROLS">
                    <h3><i class="fas fa-cogs"></i> Controles da Simulação</h3>
                    <ul>
                        <li><strong>Tipo de Sinal:</strong> Selecione diferentes formas de onda para decompor.</li>
                        <li><strong>Frequência:</strong> Ajuste a frequência fundamental do sinal.</li>
                        <li><strong>Harmônicos:</strong> Controle quantos componentes de frequência são usados na reconstrução.</li>
                        <li><strong>Velocidade:</strong> Altere a velocidade da animação.</li>
                    </ul>
                </div>
            </div>
        </main>

        <footer>
            <p>Transformada de Fourier - Visualização Interativa | Criado com Flask, HTML5 Canvas e JavaScript</p>
            <p class="footer-note">Aplicação educacional demonstrando o conceito da Transformada de Fourier</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/fourier.js') }}"></script>
    
    <!-- Efeitos Hacker Adicionais -->
    <script>
        // Adiciona efeito de terminal
        function addTerminalEffect() {
            const terminal = document.createElement('div');
            terminal.className = 'terminal-output';
            terminal.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                width: 300px;
                background: rgba(0, 10, 0, 0.9);
                border: 1px solid #00ff00;
                padding: 15px;
                font-family: 'Courier New', monospace;
                font-size: 12px;
                color: #00ff00;
                z-index: 1000;
                opacity: 0.8;
                box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
                max-height: 200px;
                overflow-y: auto;
            `;
            
            document.body.appendChild(terminal);
            
            const messages = [
                "INITIALIZING FOURIER TRANSFORM VISUALIZER...",
                "LOADING SIGNAL PROCESSING MODULES...",
                "CALIBRATING FREQUENCY DOMAIN ANALYZER...",
                "SYSTEM STATUS: ONLINE",
                "READY FOR USER INPUT"
            ];
            
            let messageIndex = 0;
            let charIndex = 0;
            let currentText = '';
            
            function typeMessage() {
                if (messageIndex < messages.length) {
                    if (charIndex < messages[messageIndex].length) {
                        currentText += messages[messageIndex].charAt(charIndex);
                        terminal.innerHTML = currentText + '<span style="color: #00ff00; animation: blink 1s infinite;">█</span>';
                        charIndex++;
                        setTimeout(typeMessage, 50);
                    } else {
                        currentText += '<br>';
                        charIndex = 0;
                        messageIndex++;
                        setTimeout(typeMessage, 500);
                    }
                } else {
                    // Mantém o terminal atualizando
                    setInterval(updateTerminalStats, 1000);
                }
            }
            
            typeMessage();
        }
        
        function updateTerminalStats() {
            const terminal = document.querySelector('.terminal-output');
            if (!terminal) return;
            
            const signalType = document.getElementById('signal-type')?.value || 'sine';
            const frequency = document.getElementById('frequency')?.value || '3.0';
            const harmonics = document.getElementById('harmonics')?.value || '5';
            const speed = document.getElementById('animation-speed')?.value || '5';
            
            const stats = [
                `SIGNAL_TYPE: ${signalType.toUpperCase()}`,
                `FREQUENCY: ${frequency}Hz`,
                `HARMONICS: ${harmonics}`,
                `SPEED: ${speed}`,
                `TIME: ${new Date().toLocaleTimeString()}`,
                '>_'
            ];
            
            terminal.innerHTML = stats.join('<br>');
        }
        
        // Adiciona partículas
        function createParticles() {
            const container = document.createElement('div');
            container.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: -1;
                overflow: hidden;
            `;
            
            document.body.appendChild(container);
            
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                const size = Math.random() * 3 + 1;
                particle.style.cssText = `
                    position: absolute;
                    width: ${size}px;
                    height: ${size}px;
                    background: #00ff00;
                    border-radius: 50%;
                    opacity: ${Math.random() * 0.3 + 0.1};
                    box-shadow: 0 0 10px #00ff00;
                `;
                
                particle.style.left = `${Math.random() * 100}vw`;
                particle.style.top = `${Math.random() * 100}vh`;
                
                container.appendChild(particle);
                animateParticle(particle);
            }
        }
        
        function animateParticle(particle) {
            let x = parseFloat(particle.style.left);
            let y = parseFloat(particle.style.top);
            const speedX = (Math.random() - 0.5) * 0.5;
            const speedY = (Math.random() - 0.5) * 0.5;
            
            function move() {
                x += speedX;
                y += speedY;
                
                if (x <= 0 || x >= 100) particle.style.left = `${Math.random() * 100}vw`;
                if (y <= 0 || y >= 100) particle.style.top = `${Math.random() * 100}vh`;
                
                particle.style.left = `${x}vw`;
                particle.style.top = `${y}vh`;
                
                requestAnimationFrame(move);
            }
            
            move();
        }
        
        // Efeito de glitch nos canvases
        function addCanvasGlitchEffect() {
            const canvases = document.querySelectorAll('canvas');
            
            setInterval(() => {
                if (Math.random() > 0.95) { // 5% de chance de glitch
                    canvases.forEach(canvas => {
                        const ctx = canvas.getContext('2d');
                        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                        const data = imageData.data;
                        
                        // Aplica um pequeno deslocamento aleatório
                        for (let i = 0; i < 100; i++) {
                            const idx = Math.floor(Math.random() * data.length / 4) * 4;
                            data[idx] = 255;     // R
                            data[idx + 1] = 0;   // G
                            data[idx + 2] = 255; // B
                        }
                        
                        ctx.putImageData(imageData, 0, 0);
                        
                        // Remove o glitch após 100ms
                        setTimeout(() => {
                            // Dispara um redesenho dos gráficos
                            if (window.draw) window.draw();
                        }, 100);
                    });
                }
            }, 3000);
        }
        
        // Inicializa os efeitos
        document.addEventListener('DOMContentLoaded', function() {
            addTerminalEffect();
            createParticles();
            addCanvasGlitchEffect();
            
            // Adiciona estilo para o cursor piscante
            const style = document.createElement('style');
            style.textContent = `
                @keyframes blink {
                    0%, 100% { opacity: 1; }
                    50% { opacity: 0; }
                }
                
                .glitch-active {
                    animation: glitch-effect 0.3s;
                }
                
                @keyframes glitch-effect {
                    0% { transform: translate(0); }
                    20% { transform: translate(-3px, 3px); text-shadow: 2px 0 #ff00ff; }
                    40% { transform: translate(3px, -3px); text-shadow: -2px 0 #00ffff; }
                    60% { transform: translate(-3px, 1px); }
                    80% { transform: translate(3px, -1px); }
                    100% { transform: translate(0); }
                }
            `;
            document.head.appendChild(style);
            
            // Adiciona efeito de glitch aleatório no título
            setInterval(() => {
                if (Math.random() > 0.95) {
                    document.querySelector('h1').classList.add('glitch-active');
                    setTimeout(() => {
                        document.querySelector('h1').classList.remove('glitch-active');
                    }, 300);
                }
            }, 5000);
        });
    </script>
</body>
</html>